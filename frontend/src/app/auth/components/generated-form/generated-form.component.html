<ng-container *ngIf="(form$ | async) as form">
  <form [action]="form.ui.action" [method]="form.ui.method">

    <ng-container *ngFor="let node of form.ui.nodes">

      <input *ngIf="node.attributes.type === 'hidden'" [disabled]="node.attributes.disabled"
        [name]="node.attributes.name" [required]="node.attributes.required" [type]="node.attributes.type"
        [value]="node.attributes.value">

      <div *ngIf="node.attributes.type !== 'submit' &&
      node.attributes.type !== 'hidden' &&
      node.attributes.name !== 'traits.image'" class="mb-3">

        <a *ngIf="node.type === 'a'" class="btn btn-success" [href]="node.attributes.href">
          {{ node.meta.label?.text }}
        </a>

        <input *ngIf="node.type === 'input'" 
          class="form-control"
          [disabled]="node.attributes.disabled"
          [name]="node.attributes.name" [required]="node.attributes.required" [type]="node.attributes.type"
          [value]="node.attributes.value? node.attributes.value: null" [placeholder]="node.meta.label?.text" />

        <span *ngFor="let message of node.messages" class="text-danger small"
          [ngClass]="{'text-danger': message.type === 'error'}">
          {{ message.text }}
        </span>
      </div>

      <div class="mb-3" *ngIf="node.attributes.type === 'submit'">
        <button class="btn btn-info" [disabled]="node.attributes.disabled" [name]="node.attributes.name"
          [value]="node.attributes.value" [type]="node.attributes.type">{{ node.meta.label?.text }}</button>
      </div>

    </ng-container>


    <div *ngFor="let message of form.ui.messages" class="alert mt-4" role="alert" [ngClass]="{
                    'alert-warning': message.type === 'error',
                    'alert-success': message.type === 'success',
                    'alert-info': message.type === 'info'}">
      {{message.text}}
    </div>

  </form>
</ng-container>